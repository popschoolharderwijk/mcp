---
description: Constraints to apply when making an implementation plan
alwaysApply: true
---

# Plan Constraints

**DRY (Don't Repeat Yourself)** is applied strictly: do not duplicate logic, types, or UI; reuse existing components, types, and helpers. The plan must reflect this.

When making an implementation plan, apply these constraints **in this order**:

1. **Types**
   - Reuse types from `./src/types` or from `./src/integrations/supabase/types.ts` (Supabase generated types).
   - Only add new types to `./src/types` if the type will be reused; base new types on Supabase types where applicable.

2. **Database / Supabase types**
   - After **any database changes** (migrations, schema): the plan must include running **`bun run reset-db:dev`**. This resets the local database and regenerates the Supabase types.
   - **Never** edit `./src/integrations/supabase/types.ts` by hand; it is generated.

3. **UI components**
   - The plan must **explicitly include** reviewing `./src/components/ui` first to get an overview of what exists; then use those existing components before introducing new ones.
   - For **larger UI loading** (pages, sections): use **PageSkeleton** or **SectionSkeleton** from `page-skeleton.tsx` (variants: `header-and-cards`, `header-and-tabs`, `header-only`). No ad-hoc skeleton layouts for pages/sections.

4. **Icons**
   - Use only icons from **react-icons** (e.g. `react-icons/lu`, `react-icons/fi`); do **not** use `lucide-react`.

5. **Data overviews**
   - Use the DataTable component (`data-table.tsx`) for any data overview or table.

6. **Date/time formatting**
   - Use the helpers in `./src/lib/date` and `./src/lib/time` only; do not format dates/times inline.

7. **Completion**
   - Plan must include a final step: run `bun run check`, then `bun run ci`; fix errors until `bun run ci` passes.

## Checklist for plans

Before implementing, the plan should satisfy:

- [ ] DRY: no duplication of logic, types, or UI; reuse existing components, types, and helpers.
- [ ] Types: reused from `./src/types` or Supabase; new types only in `./src/types` when reused.
- [ ] Database: if schema changed, plan includes `bun run reset-db:dev`; never edit `./src/integrations/supabase/types.ts` by hand.
- [ ] UI: plan includes reviewing `./src/components/ui` first; existing components used where possible; skeletons (PageSkeleton/SectionSkeleton) for larger loading; end pages have PageHeader at top and set breadcrumb suffix.
- [ ] Icons: from `react-icons` only (e.g. `react-icons/lu`); not from `lucide-react`.
- [ ] Data overviews: DataTable (`data-table.tsx`) used.
- [ ] Date/time: helpers from `./src/lib/date` and `./src/lib/time` used.
- [ ] Final step: `bun run check` then `bun run ci` until passing.
